<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.ac.jejuuniv.twitter.repository.TwitterRepository">

	<!-- 트위터 글쓰기 -->
	<insert id="writeTwitt" parameterType="kr.ac.jejuuniv.twitter.model.TwittModel">
		Insert into twitt(id, name, content, write_date) values(#{id},#{name},#{content},#{write_date})
	</insert>
	
	<!--내가 쓴 트위터 글 보기  -->		
	<select id="getMyTwittOrderByDate" parameterType="String" resultType="kr.ac.jejuuniv.twitter.model.TwittModel">
		Select * from twitt where id=#{id} order by write_date desc	
	</select>
	
	<!-- 트위터 글 보기  -->
	<select id="getTwittListOderByDate" parameterType="String" resultType="kr.ac.jejuuniv.twitter.model.TwittModel">
		select distinct twitt.* from follow left outer join twitt on twitt.id=follow.following 
		where follow.id=#{id} or twitt.id=#{id} order by write_date desc 
	</select>
	
	<!-- 트위터 글삭제 -->
	<delete id="deleteMyTwitt" parameterType="int">
		Delete from twitt where twinum=#{twit_num}
	</delete>
	
	<!-- Following 등록 -->
	<insert id="addFollowingById" parameterType="kr.ac.jejuuniv.twitter.model.FollowingModel">
		Insert into follow(id, following) values(#{id},#{following})	
	</insert>
	
	<!-- Follower 목록-->
	<select id="getAllFollower" parameterType="String" resultType="kr.ac.jejuuniv.twitter.model.FollowModel">
			Select * from follow where id=#{id}
	</select>
	
	<!--Following 목록  -->
	<select id="getFollowingById" parameterType="String" resultType="kr.ac.jejuuniv.twitter.model.FollowModel">
		Select follow.following as "id",
		 user.name, user.profile from follow inner join user on follow.following=user.id where follow.id=#{id}
	</select> 
	
	<!--UnFollowing  -->
	<delete id="unFollowingById" parameterType="String">
		Delete from follow where id=#{id} and following=#{following}
	</delete>
	
	<!--getFollower  -->
	<select id="getFollowerById" parameterType="String" resultType="kr.ac.jejuuniv.twitter.model.FollowModel">
		Select user.id, user.name, user.profile from user inner join follow on follow.id=user.id where following=#{id}
	</select>
	
	<select id="getFollowingList" parameterType="String" resultType="String">
		Select following from follow where id=#{id};
	</select>
	
<!--
	Hash로 할려다가 막힘 .. 
	<select id="getTestHash" resultType="hashmap">
		Select user.id, user.name, user.profile from user inner join follow on follow.id=user.id where following="juntheater"
	</select>
	
	<select id="getTestHash2" resultType="String">
		Select following from follow where id="juntheater";
	</select> 	
	<select id="follwerTest" parameterType="String" resultMap="follwTest">
		Select 
	</select>
	
	<resultMap id="followTest" type="kr.ac.jejuuniv.twitter.model.FollowTestModel">
		<id property="id" column="id"/>
		
	</resultMap>
	
	<resultMap id="getFollowerProfile" type="kr.ac.jejuuniv.twitter.model.UserModel">
		<id property="id" column="id"/>
		<result property="name" column="name"/>
		<result property="profile" column="profile"/>
	</resultMap> -->
	
</mapper>